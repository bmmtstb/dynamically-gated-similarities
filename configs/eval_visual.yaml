name: "Evaluate Visual Similarity Classification"
description: "Evaluate the visual similarity using visual embeddings generated by torchreid models.
This config uses the engine of the dgs module."

device: "cuda"
print_prio: "DEBUG"
is_training: off
log_dir: "./results/own/visual_sim/"

test:
    metric: "EuclideanSquareMetric"  # used to compute the distance matrix between target and predicted embeddings
    topk_cmc: [1,2,3,5,10,20, 50, 100, 1000]
    write_embeds: [True, False]

# #### #
# DATA #
# #### #

dataloader_valid:
    module_name: "PoseTrack21"
    dataset_path: "./data/PoseTrack21/"
    json_path: "./posetrack_person_search/val.json"
    force_img_reshape: true
    crops_folder: "./crops/gallery/"
    batch_size: 256

dataloader_test:
    module_name: "PoseTrack21"
    dataset_path: "./data/PoseTrack21/"
    json_path: "./posetrack_person_search/query.json"
    force_img_reshape: true
    crops_folder: "./crops/query/"
    batch_size: 1024

# ####### #
# MODULES #
# ####### #

similarity_visual:
    module_name: "torchreid"  # see `dgs.models.similarity.__init__`
    model_name: "osnet_ain_x1_0"
    similarity: "EuclideanSquare"
    weights: "pretrained"
    nof_classes: 5474
