name: "Evaluate Visual Similarity Classification"
description: "Evaluate the visual similarity using visual embeddings generated by torchreid models.
This config uses the engine of the dgs module."

device: "cuda"
print_prio: "DEBUG"
is_training: off
log_dir: "./results/own/visual_sim/"

test:
    metric: "EuclideanSquaredDistance"  # used to compute the distance matrix between target and predicted embeddings
    topk: [1,2,3,5,10,20,50]

# #### #
# DATA #
# #### #

dataloader_valid:
    module_name: "PoseTrack21"
    dataset_path: "./data/PoseTrack21/"
    json_path: "./posetrack_person_search/val.json"
    force_img_reshape: true
    crops_folder: "./crops/gallery/"
    requires_grad: false
    batch_size: 256

dataloader_test:
    module_name: "PoseTrack21"
    dataset_path: "./data/PoseTrack21/"
    json_path: "./posetrack_person_search/query.json"
    force_img_reshape: true
    crops_folder: "./crops/query/"
    requires_grad: false
    batch_size: 256

# ####### #
# MODULES #
# ####### #

embedding_generator_visual:
    module_name: "TorchreidModel"  # see `dgs.models.embedding_generator.__init__`
    model_name: "osnet_ain_x1_0"
    embedding_size: 512
    nof_classes: 7529
