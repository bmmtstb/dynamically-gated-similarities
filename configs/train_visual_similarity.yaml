name: "Visual Similarity (Own)"
description: "Train the visual similarity using visual embeddings generated by torchreid models.
This config uses the engine of the dgs module."

device: "cuda"
print_prio: "DEBUG"
is_training: on
log_dir: "./results/own/visual_sim/"


train:
    epochs: 5
    loss: "TorchreidCrossEntropyLoss"
    loss_kwargs:
        num_classes: 7529
    optimizer: "Adam"
    optimizer_kwargs:
        lr: 0.0003
        weight_decay: 0.0001
    nof_classes: 7529
    topk: (1,)

test:
    metric: "EuclideanDistance"  # used to compute the distance matrix between target and predicted embeddings
    topk: (1,2,3,5,10,20,50)

# #### #
# DATA #
# #### #

dataset_train:
    module_name: "PoseTrack21"
    dataset_path: "./data/PoseTrack21/"
    json_path: "./posetrack_data/train/"
#    json_path: "./posetrack_data/train_first_half/"
#    json_path: "./posetrack_data/train/000001_bonn_train.json"
    crops_folder: "./crops/train/"
    requires_grad: false

dataset_valid:
    module_name: "PoseTrack21"
    dataset_path: "./data/PoseTrack21/"
    json_path: "./posetrack_person_search/val.json"
    force_img_reshape: true
    crops_folder: "./crops/gallery/"
    requires_grad: false

dataset_test:
    module_name: "PoseTrack21"
    dataset_path: "./data/PoseTrack21/"
    json_path: "./posetrack_person_search/query.json"
    force_img_reshape: true
    crops_folder: "./crops/query/"
    requires_grad: false

# ####### #
# MODULES #
# ####### #

embedding_generator_visual:
    module_name: "TorchreidModel"  # see `dgs.models.embedding_generator.__init__`
    model_name: "osnet_ain_x1_0"
    embedding_size: 512
    nof_classes: 7529
