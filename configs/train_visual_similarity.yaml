name: "Train Visual Similarity"
description: "Train the visual similarity using visual embeddings generated by torchreid models.
This config uses the engine of the dgs module."

device: "cuda"
print_prio: "debug"
is_training: on

train:
    epochs: 1
    loss: "CrossEntropyLoss"
    optimizer: "Adam"

test:
    metric: "CosineDistance"
    log_dir: "./results/own_visual_sim/"

# #### #
# DATA #
# #### #

dataset_train:
    module_name: "PoseTrack21"
    dataset_path: "./data/PoseTrack21/"
    json_path: "./posetrack_data/train/"
#    json_path: "./posetrack_data/train/000001_bonn_train.json"
    crops_folder: "./crops/train/"
    requires_grad: true

dataset_test:
    module_name: "PoseTrack21"
    dataset_path: "./data/PoseTrack21/"
    json_path: "./posetrack_data/val/"
#    json_path: "./posetrack_data/val/000342_mpii_test.json"
    force_img_reshape: true
    crops_folder: "./crops/val/"
    requires_grad: false

dataset_valid:
    module_name: "PoseTrack21JSON"
    dataset_path: "./data/PoseTrack21/"
    json_path: "./posetrack_person_search/query.json"
    force_img_reshape: true
    crops_folder: "./crops/query/"
    requires_grad: false

# ####### #
# MODULES #
# ####### #

embedding_generator_visual:
    module_name: "TorchreidModel"  # see `dgs.models.embedding_generator.__init__`
    model_name: "osnet_ain_x1_0"
    embedding_size: 512
    nof_classes: 5474

